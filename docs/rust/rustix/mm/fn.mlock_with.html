<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="`mlock2(ptr, len, flags)`—Lock memory into RAM, with flags."><title>mlock_with in rustix::mm - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-c5d6553a23f1e5a6.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="rustix" data-themes="" data-resource-suffix="" data-rustdoc-version="1.81.0 (eeb90cda1 2024-09-04)" data-channel="1.81.0" data-search-js="search-d234aafac6c221dd.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-d2fab2bf619172d3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../rustix/index.html">rustix</a><span class="version">0.38.37</span></h2></div><div class="sidebar-elems"><h2><a href="index.html">In rustix::mm</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../index.html">rustix</a>::<wbr><a href="index.html">mm</a>::<wbr><a class="fn" href="#">mlock_with</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../src/rustix/mm/mmap.rs.html#305-307">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub unsafe fn mlock_with(
    ptr: <a class="primitive" href="https://doc.rust-lang.org/1.81.0/std/primitive.pointer.html">*mut </a><a class="enum" href="https://doc.rust-lang.org/1.81.0/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>,
    len: <a class="primitive" href="https://doc.rust-lang.org/1.81.0/std/primitive.usize.html">usize</a>,
    flags: <a class="struct" href="struct.MlockFlags.html" title="struct rustix::mm::MlockFlags">MlockFlags</a>,
) -&gt; <a class="type" href="../io/type.Result.html" title="type rustix::io::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.81.0/std/primitive.unit.html">()</a>&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p><code>mlock2(ptr, len, flags)</code>—Lock memory into RAM, with flags.</p>
<p><code>mlock_with</code> is the same as <a href="fn.mlock.html" title="fn rustix::mm::mlock"><code>mlock</code></a> but adds an additional flags operand.</p>
<h2 id="safety"><a class="doc-anchor" href="#safety">§</a>Safety</h2>
<p>This function operates on raw pointers, but it should only be used on
memory which the caller owns. Technically, locking memory shouldn’t violate
any invariants, but since unlocking it can violate invariants, this
function is also unsafe for symmetry.</p>
<p>Some implementations implicitly round the memory region out to the nearest
page boundaries, so this function may lock more memory than explicitly
requested if the memory isn’t page-aligned.</p>
<h2 id="references"><a class="doc-anchor" href="#references">§</a>References</h2>
<ul>
<li><a href="https://man7.org/linux/man-pages/man2/mlock2.2.html">Linux</a></li>
<li><a href="https://www.gnu.org/software/libc/manual/html_node/Page-Lock-Functions.html#index-mlock2">glibc</a></li>
</ul>
</div></details></section></div></main></body></html>